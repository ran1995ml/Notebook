# 特点

分布式版本控制系统，客户端不只提取最新版本的文件快照，而是把代码仓库完整镜像下来。这样任何一处服务器发生故障，都可用任何一个镜像出来的本地仓库恢复。每次提取操作，都是对代码仓库的完整备份。客户端相当于服务端，思想：去中心化。

管理项目时，存放的是索引，将压缩技术用到极致，所需磁盘空间很少，每个客户端可放下整个项目的历史纪录。

区域分为工作区（写代码的目录）、暂存区（临时存储）、本地库。

# 初始化配置

使用git config命令配置读取相应的工作环境变量，首先要配置的是个人用户名和邮箱，每次Git提交回引用这两条信息，说明是谁提交

```shell
git config --global user.name "**"
git config --global user.email **@email.com
```

查看配置信息

```shell
git config --list
```

初始化仓库后，目录下生成版本库.git，包含如下目录文件：

- hooks：包含客户端或服务端的钩子脚本；
- info：包含一个全局性排除文件；
- logs：保存日志信息；
- objects：存储所有数据内容；
- refs：存储指向数据分支的提交对象的指针
- HEAD：目前被检测出的分支；
- index：保存暂存区信息

```shell
git init
```

# Git对象

Git核心是一个键值对数据库，可插入任 意类型内容返回一个键值，通过该键值可在任意时刻再次检索该内容。

Git对象实质是kv组成的键值对，k是v对应的hash，类型是blob类型。保存的是每个文件每个版本的内容，只能通过hash值获取内容，记住每个文件每个版本的hash值并不现实。

树对象解决文件名保存问题，将多个文件组织在一起。Git以类似Unix文件系统的方式存储内容，以树对象和Git对象的形式存储，树对象对应Unix中的目录项，Git对象对应文件内容。树对象中的每条记录包含一个指向Git对象或子树对象的指针。

Git对象代表文件的一个版本，树对象代表项目的一个版本，构建生成的树对象会放入暂存区。

提交对象是对树对象的封装，包含该树对象、提交人信息及提交对象的父对象。回退版本找到对应提交对象的哈希值即可回退。

Git每次版本存的不是增量，而是快照。

项目的版本是一个提交对象，快照是一个树对象。

# 高层指令

```shell
git add ./
```

将修改添加到暂存区。工作目录先到版本库生成Git对象，再添加到暂存区。提交时会在暂存区生成树对象放在版本库，添加注释后树对象包裹成提交对象。

```shell
git rm --cache filename
```

删除暂存区的文件。

```shell
git commit -m ""
```

添加注释将暂存区提交到版本库，提交并不会清空暂存区。

```shell
git reflog
git log
```

查看提交日志

```shell
git reset --hard 版本号
```

根据版本号回退版本

工作目录下的文件有两种状态：已跟踪和未跟踪。已跟踪的文件时已纳入版本控制管理的文件，上次快照中有它的记录，工作一段时间后状态未已提交、已修改或已暂存。

```shell
git status
```

检查文件当前处于什么状态。

```shell
git diff
git diff --cached
```

查看哪些更新没有暂存，哪些更新已暂存待提交。

```shell
# 查看有哪些分支
git branch -v
# 创建分支
git branch 分支名
# 切换分支
git checkout 分支名
# 将分支和当前分支合并
git merge 分支名
```

分支合并冲突，手动打开冲突文件修改，修改完成后：

```shell
# merge合并至暂存区
git add 文件名
# 提交版本库，不加文件名
git commit -m ""
```

创建别名方便提交

```shell
# 查看创建的仓库别名
git remote -v
# 添加别名
git remote add 别名 仓库地址
# 推送本地内容至远程库
git push 仓库别名 分支名
# 拉取远程库内容至本地库
git pull 仓库别名 分支名
```

